{{ define "title" }}{{ t "invoice" }} #{{ .Invoice.Number }}{{ end }} {{ define
"content" }}
<div class="max-w-5xl mx-auto">
  <div class="mb-6 flex justify-between items-end">
    <div>
      <a href="/invoices" class="btn btn-ghost btn-sm mb-2"
        >← {{ t "back_to_list" }}</a
      >
      <h1 class="text-2xl font-bold">
        {{ t "invoice" }} #{{ .Invoice.Number }}
      </h1>
      <div class="flex gap-2 mt-1">
        <span class="badge badge-success">{{ t "finalized" }}</span>
        <span class="text-sm opacity-50"
          >{{ .Invoice.Date.Format "02/01/2006" }}</span
        >
      </div>
    </div>
    <div class="flex gap-2">
      <a href="/invoices/{{ .Invoice.ID }}/pdf" class="btn btn-primary btn-sm">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4 mr-1"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
        {{ t "download_pdf" }}
      </a>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="md:col-span-2 space-y-6">
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <div class="flex justify-between mb-8">
            <div>
              <h3 class="font-bold text-lg mb-2">{{ t "from" }}</h3>
              <div class="text-sm">
                <p class="font-bold">{{ .Company.Name }}</p>
                <p>{{ .Company.Address }}</p>
                <p>{{ .Company.ZipCode }} {{ .Company.City }}</p>
                <p>{{ .Company.Country }}</p>
                {{ if .Company.SIRET }}
                <p class="mt-2 text-xs opacity-50">
                  SIRET: {{ .Company.SIRET }}
                </p>
                {{ end }}
              </div>
            </div>
            <div class="text-right">
              <h3 class="font-bold text-lg mb-2">{{ t "to" }}</h3>
              <div class="text-sm">
                <p class="font-bold">{{ .Invoice.Client.Name }}</p>
                <p>{{ .Invoice.Client.Address }}</p>
                <p>{{ .Invoice.Client.ZipCode }} {{ .Invoice.Client.City }}</p>
                <p>{{ .Invoice.Client.Country }}</p>
                {{ if .Invoice.Client.TaxID }}
                <p class="mt-2 text-xs opacity-50">
                  VAT: {{ .Invoice.Client.TaxID }}
                </p>
                {{ end }}
              </div>
            </div>
          </div>

          <div class="overflow-x-auto">
            <table class="table w-full">
              <thead>
                <tr>
                  <th>{{ t "description" }}</th>
                  <th class="text-right">{{ t "qty" }}</th>
                  <th class="text-right">{{ t "unit_price" }}</th>
                  <th class="text-right">{{ t "total_ht" }}</th>
                </tr>
              </thead>
              <tbody>
                {{ range .Invoice.Items }}
                <tr>
                  <td>
                    <div class="font-bold">{{ .Product.Name }}</div>
                    <div class="text-xs opacity-50">{{ .Product.Code }}</div>
                  </td>
                  <td class="text-right">
                    {{ .Quantity }} {{ .Product.Unit }}
                  </td>
                  <td class="text-right">{{ .UnitPrice }} €</td>
                  <td class="text-right">{{ mul .UnitPrice .Quantity }} €</td>
                </tr>
                {{ end }}
              </tbody>
            </table>
          </div>

          <div class="flex justify-end mt-8">
            <div class="w-64 space-y-2">
              <div class="flex justify-between">
                <span>{{ t "total_ht" }}</span>
                <span>{{ printf "%.2f" .Totals.HT }} €</span>
              </div>
              <div class="flex justify-between">
                <span>{{ t "total_vat" }}</span>
                <span>{{ printf "%.2f" .Totals.VAT }} €</span>
              </div>
              <div class="divider my-1"></div>
              <div class="flex justify-between font-bold text-xl">
                <span>{{ t "total_ttc" }}</span>
                <span>{{ printf "%.2f" .Totals.TTC }} €</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">{{ t "payment_info" }}</h2>
          <div class="space-y-4 mt-2">
            <div>
              <div class="text-sm opacity-50">{{ t "due_date" }}</div>
              <div class="font-medium">
                {{ if .Invoice.DueDate }}{{ .Invoice.DueDate.Format "02/01/2006"
                }}{{ else }}---{{ end }}
              </div>
            </div>
            <div>
              <div class="text-sm opacity-50">{{ t "payment_status" }}</div>
              {{ if .Invoice.PaidAt }}
              <span class="badge badge-success">{{ t "paid" }}</span>
              <div class="text-xs mt-1 opacity-50">
                {{ .Invoice.PaidAt.Format "02/01/2006" }}
              </div>
              {{ else }}
              <span class="badge badge-warning">{{ t "pending" }}</span>
              <form
                action="/invoices/{{ .Invoice.ID }}/pay"
                method="POST"
                class="mt-2"
              >
                <button type="submit" class="btn btn-outline btn-sm btn-block">
                  {{ t "mark_as_paid" }}
                </button>
              </form>
              {{ end }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{{ end }}
